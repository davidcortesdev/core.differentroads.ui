<p-card styleClass="passenger-card-panel">
  <ng-template #header>
    <div class="passenger-header">
      <i class="pi pi-user"></i>
      <span class="passenger-type">{{getPassengerTypeLabel(passenger.type)}}</span>
    </div>
  </ng-template>
  
  <!-- View Mode -->
  <div class="passenger-content" *ngIf="!isEditing">
   
    <div class="detail-row hab">
      <span class="detail-label hab">Habitación:</span>
      <span class="detail-value hab" [ngClass]="{'pending-value': !passenger.room}">{{passenger.room || 'Pendiente'}}</span>
    </div>
    
    <div class="passenger-details">
      <div class="passenger-name">
        <h3>{{passenger.fullName || 'Pendiente'}}</h3>
      </div>
      <div class="detail-row">
        <span class="detail-label">Teléfono:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.phone}">{{passenger.phone || 'Pendiente'}}</span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Email:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.email}">{{passenger.email || 'Pendiente'}}</span>
      </div>
      <p-divider></p-divider>

      <div class="detail-row">
        <span class="detail-label">Sexo:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.gender}">{{passenger.gender || 'Pendiente'}}</span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Fecha de nacimiento:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.birthDate}">{{passenger.birthDate ? formatDate(passenger.birthDate) : 'Pendiente'}}</span>
      </div>
      <p-divider></p-divider>

      <div class="detail-row">
        <span class="detail-label">Tipo de documento:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.documentType}">{{passenger.documentType || 'Pendiente'}}</span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Número de documento:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.documentNumber}">{{passenger.documentNumber || 'Pendiente'}}</span>
      </div>
      
      <div class="detail-row">
        <span class="detail-label">Fecha de expedición:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.documentExpeditionDate}">
          {{passenger.documentExpeditionDate || 'Pendiente'}}
        </span>
      </div>
      
      <div class="detail-row">
        <span class="detail-label">Fecha de caducidad:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.documentExpirationDate}">
          {{passenger.documentExpirationDate || 'Pendiente'}}
        </span>
      </div>
      <p-divider></p-divider>
      
      <div class="detail-row">
        <span class="detail-label">Comfort Plan:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.comfortPlan}">{{passenger.comfortPlan || 'Pendiente'}}</span>
      </div>
      
      <div class="detail-row">
        <span class="detail-label">Seguro:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.insurance}">{{passenger.insurance || 'Pendiente'}}</span>
      </div>
    </div>
  </div>
  
  <!-- Edit Mode -->
  <div class="passenger-content edit-mode" *ngIf="isEditing">
    <form [formGroup]="passengerForm">
      <div class="passenger-name">
        <h3>
          <input type="text" pInputText formControlName="fullName" class="w-full">
        </h3>
      </div>
      
      <div class="passenger-details">
        <div class="detail-row">
          <span class="detail-label">Habitación:</span>
          <input type="text" pInputText formControlName="room" class="detail-value">
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Sexo:</span>
          <input type="text" pInputText formControlName="gender" class="detail-value">
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Tipo de Documento:</span>
          <input type="text" pInputText formControlName="documentType" class="detail-value">
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Número de Documento:</span>
          <input type="text" pInputText formControlName="documentNumber" class="detail-value">
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Fecha de expedición:</span>
          <input type="text" pInputText formControlName="documentExpeditionDate" class="detail-value">
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Fecha de caducidad:</span>
          <input type="text" pInputText formControlName="documentExpirationDate" class="detail-value">
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Fecha de nacimiento:</span>
          <input type="text" pInputText formControlName="birthDate" class="detail-value">
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Email:</span>
          <input type="text" pInputText formControlName="email" class="detail-value">
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Teléfono:</span>
          <input type="text" pInputText formControlName="phone" class="detail-value">
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Comfort Plan:</span>
          <input type="text" pInputText formControlName="comfortPlan" class="detail-value">
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Seguro:</span>
          <input type="text" pInputText formControlName="insurance" class="detail-value">
        </div>
      </div>
    </form>
  </div>
  
  <ng-template #footer>
    <div class="passenger-footer">
      <!-- Pending fields indicator - only show in view mode -->
      <div *ngIf="!isEditing && hasPendingFields()" class="pending-fields-indicator">
        <i class="pi pi-info-circle"></i>
        <span>Completa tus datos personales pendientes antes de tu viaje.</span>
      </div>
      
      <!-- This spacer ensures the edit button is always on the right, even if no pending indicator -->
      <div *ngIf="!isEditing && !hasPendingFields()" class="flex-spacer"></div>
      
      <!-- Edit button in view mode -->
      <div class="edit-button-container">
        <p-button 
          *ngIf="!isEditing"
          icon="pi pi-pencil" 
          styleClass="p-button-rounded p-button-text" 
          pTooltip="Editar pasajero"
          (onClick)="onEdit()">
        </p-button>
      </div>
      
      <!-- Save buttons in edit mode -->
      <div *ngIf="isEditing" class="edit-buttons">
        <p-button 
          label="Guardar" 
          icon="pi pi-check" 
          styleClass="p-button-success"
          (onClick)="onSave()">
        </p-button>
        <p-button 
          icon="pi pi-times" 
          styleClass="p-button-text p-button-danger ml-2"
          (onClick)="onCancel()">
        </p-button>
      </div>
    </div>
  </ng-template>
</p-card>