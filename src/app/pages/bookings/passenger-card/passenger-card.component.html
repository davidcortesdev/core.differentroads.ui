<p-card styleClass="passenger-card-panel">
  <ng-template #header>
    <div class="passenger-header">
      <i class="pi pi-user"></i>
      <span class="passenger-type">{{getPassengerTypeLabel(passenger.type)}}</span>
    </div>
  </ng-template>
  
  <!-- View Mode -->
  <div class="passenger-content" *ngIf="!isEditing">
   
    <div class="detail-row hab">
      <span class="detail-label hab">Habitación:</span>
      <span class="detail-value hab" [ngClass]="{'pending-value': !passenger.room}">{{passenger.room || 'Pendiente'}}</span>
    </div>
    
    <div class="passenger-details">
      <div class="passenger-name">
        <h3>{{passenger.fullName || 'Pendiente'}}</h3>
      </div>
      <div class="detail-row">
        <span class="detail-label">Teléfono:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.phone}">{{passenger.phone || 'Pendiente'}}</span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Email:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.email}">{{passenger.email || 'Pendiente'}}</span>
      </div>
      <p-divider></p-divider>

      <div class="detail-row">
        <span class="detail-label">Sexo:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.gender}">
          {{ getGenderLabel(passenger.gender) }}
        </span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Fecha de nacimiento:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.birthDate}">
          {{passenger.birthDate ? formatDate(passenger.birthDate) : 'Pendiente'}}
        </span>
      </div>
      <p-divider></p-divider>

      <div class="detail-row">
        <span class="detail-label">Tipo de documento:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.documentType}">
          {{ getDocumentTypeLabel(passenger.documentType) }}
        </span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Número de documento:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.documentNumber}">{{passenger.documentNumber || 'Pendiente'}}</span>
      </div>
      
      <div class="detail-row">
        <span class="detail-label">Fecha de expedición:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.documentExpeditionDate}">
          {{passenger.documentExpeditionDate ? formatDate(passenger.documentExpeditionDate || '') : 'Pendiente'}}
        </span>
      </div>
      
      <div class="detail-row">
        <span class="detail-label">Fecha de caducidad:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.documentExpirationDate}">
          {{passenger.documentExpirationDate ? formatDate(passenger.documentExpirationDate || '') : 'Pendiente'}}
        </span>
      </div>
      <p-divider></p-divider>
      
      <div class="detail-row">
        <span class="detail-label">Comfort Plan:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.comfortPlan}">{{passenger.comfortPlan || 'Pendiente'}}</span>
      </div>
      
      <div class="detail-row">
        <span class="detail-label">Seguro:</span>
        <span class="detail-value" [ngClass]="{'pending-value': !passenger.insurance}">{{passenger.insurance || 'Pendiente'}}</span>
      </div>
    </div>
  </div>
  
  <!-- Edit Mode -->
  <div class="passenger-content edit-mode" *ngIf="isEditing">
    <form [formGroup]="passengerForm">
      <div class="passenger-name">
        <h3>
          <input type="text" pInputText formControlName="fullName" class="w-full">
        </h3>
      </div>
      
      <div class="update-passenger-details">
        <div class="detail-row">
          <span class="detail-label">Habitación:</span>
          <span class="detail-value hab" [ngClass]="{'pending-value': !passenger.room}">{{passenger.room || 'Pendiente'}}</span>
        </div>
        
        <div class="form-field">
          <label>Sexo:</label>
          <p-dropdown
            formControlName="gender"
            name="sexo"
            [options]="genderOptions"
            optionLabel="label"
            optionValue="value"
            placeholder="Seleccione su sexo"
            [disabled]="!isEditing"
            styleClass="custom-dropdown"
            [showClear]="true"
            [autoDisplayFirst]="false"
          ></p-dropdown>
        </div>
        
        <div class="form-field">
          <label>Tipo de Documento:</label>
          <p-dropdown
            formControlName="documentType"
            name="Tipo de Documento"
            [options]="documentTypeOptions"
            optionLabel="label"
            optionValue="value"
            placeholder="Seleccione tipo de Documento"
            [disabled]="!isEditing"
            styleClass="custom-dropdown"
            [showClear]="true"
            [autoDisplayFirst]="false"
          ></p-dropdown>
        </div>
        
        <div class="form-field">
          <label>Número de Documento:</label>
        <input
          pInputText
          formControlName="documentNumber"
          placeholder="Ingrese su teléfono"
        />
        </div>
        
        <div class="form-field">
          <label>Fecha de expedición:</label>
          <p-datepicker
            formControlName="documentExpeditionDate"
            placeholder="dd/mm/aaaa"
            [showIcon]="true"
            appendTo="body"
            dateFormat="dd/mm/yy"
            [maxDate]="today"
          >
        </p-datepicker>
        </div>
        
        <div class="form-field">
          <label>Fecha de caducidad:</label>
          <p-datepicker
            formControlName="documentExpirationDate"
            placeholder="dd/mm/aaaa"
            [showIcon]="true"
            appendTo="body"
            dateFormat="dd/mm/yy"
            [minDate]="today"
          >
          </p-datepicker>
        </div>
        
        <div class="form-field">
          <label>Fecha de nacimiento:</label>
            <p-datepicker
            formControlName="birthDate"
            placeholder="dd/mm/aaaa"
            [showIcon]="true"
            appendTo="body"
            dateFormat="dd/mm/yy"
            [maxDate]="today"
            >
            </p-datepicker>
        </div>
      
        
        <div class="form-field">
          <label>Email:</label>
        <input
          pInputText
          formControlName="email"
          placeholder="Ingrese su código email"
        />
        </div>
        
        <div class="form-field">
          <label>Teléfono:</label>
        <input
        pInputText
        formControlName="phone"
        placeholder="Ingrese su teléfono"
      />
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Comfort Plan:</span>
          <span class="detail-value" [ngClass]="{'pending-value': !passenger.comfortPlan}">{{passenger.comfortPlan || 'Pendiente'}}</span>
        </div>
        
        <div class="detail-row">
          <span class="detail-label">Seguro:</span>
          <span class="detail-value" [ngClass]="{'pending-value': !passenger.insurance}">{{passenger.insurance || 'Pendiente'}}</span>
        </div>
      </div>
    </form>
  </div>
  
  <ng-template #footer>
    <div class="passenger-footer">
      <div *ngIf="!isEditing && hasPendingFields()" class="pending-fields-indicator">
        <i class="pi pi-info-circle"></i>
        <span>Completa tus datos personales pendientes antes de tu viaje.</span>
      </div>
      
      <!-- This spacer ensures the edit button is always on the right, even if no pending indicator -->
      <div *ngIf="!isEditing && !hasPendingFields()" class="flex-spacer"></div>
      
      <!-- Edit button in view mode -->
      <div class="edit-button-container">
        <p-button 
          *ngIf="!isEditing"
          icon="pi pi-pencil" 
          styleClass="p-button-rounded p-button-text" 
          pTooltip="Editar pasajero"
          (onClick)="onEdit()">
        </p-button>
      </div>
      
      <!-- Save buttons in edit mode -->
      <div *ngIf="isEditing" class="edit-buttons">
        <p-button 
          label="Guardar" 
          icon="pi pi-check" 
          styleClass="p-button-success"
          (onClick)="onSave()">
        </p-button>
        <p-button 
          icon="pi pi-times" 
          styleClass="p-button-text p-button-danger ml-2"
          (onClick)="onCancel()">
        </p-button>
      </div>
    </div>
  </ng-template>
</p-card>