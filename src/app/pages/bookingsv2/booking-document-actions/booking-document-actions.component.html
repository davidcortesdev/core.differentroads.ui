<!-- app.component.html -->
<div class="container" *ngIf="isVisible">
  <p-panel styleClass="custom-panel">
    <div class="buttons-container">
      <p-button
        label="Enviar a TK"
        icon="pi pi-refresh"
        [disabled]="!canEnqueueSync"
        (onClick)="onEnqueueSync()"
        [pTooltip]="!canEnqueueSync ? getEnqueueSyncTooltip() : ''"
        tooltipPosition="top"
        [loading]="isProcessingEnqueueSync"
      >
      </p-button>
      <p-button
        label="Traer de TK"
        icon="pi pi-download"
        [disabled]="!canSyncFromTk"
        (onClick)="onSyncFromTk()"
        [pTooltip]="!canSyncFromTk ? getSyncFromTkTooltip() : ''"
        tooltipPosition="top"
        [loading]="isProcessingSyncFromTk"
      >
      </p-button>
      <p-button
        *ngFor="let action of getVisibleActions()"
        [icon]="action.icon"
        [label]="action.test"
        (onClick)="onActionClick(action)"
      >
      </p-button>
    </div>
  </p-panel>
</div>

<!-- Modal para email -->
<p-dialog
  [header]="getModalTitle()"
  [(visible)]="showEmailModal"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  [closable]="true"
  [style]="{ width: '90vw', maxWidth: '500px' }"
  styleClass="email-modal-dialog"
  (onHide)="closeEmailModal()"
>
  <div class="email-modal-container">
    <div class="email-input-section mb-4">
      <label for="emailInput" class="input-label">
        Email <span class="required">*</span>
      </label>
      <div class="input-with-icon">
        <i class="pi pi-envelope input-icon"></i>
        <input
          id="emailInput"
          type="email"
          pInputText
          [(ngModel)]="userEmail"
          placeholder="Ingrese el email"
          class="email-input"
          [disabled]="isLoadingEmail"
        />
      </div>
      <small class="help-text" *ngIf="!isLoadingEmail"> </small>
      <small class="loading-text" *ngIf="isLoadingEmail">
        Cargando email...
      </small>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <div class="dialog-footer">
      <p-button
        label="Cancelar"
        icon="pi pi-times"
        styleClass="p-button-text"
        (onClick)="closeEmailModal()"
        [disabled]="isProcessing"
      >
      </p-button>
      <p-button
        *ngIf="hasDocumentCode()"
        label="Descargar"
        icon="pi pi-download"
        styleClass="p-button-secondary"
        (onClick)="onDownload()"
        [loading]="isProcessing"
        [disabled]="isProcessing"
      >
      </p-button>
      <p-button
        *ngIf="hasEmailCode()"
        label="Enviar"
        icon="pi pi-send"
        styleClass="p-button-primary"
        (onClick)="onSend()"
        [loading]="isProcessing"
        [disabled]="isProcessing || !userEmail"
      >
      </p-button>
    </div>
  </ng-template>
</p-dialog>
