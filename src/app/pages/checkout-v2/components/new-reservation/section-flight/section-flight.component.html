<!-- section-flight.component.html -->
<p-panel styleClass="flight-pan" *ngIf="hasFlights">
    <ng-template #header>
      <div class="pan-hdr">Información de vuelos</div>
    </ng-template>
    <div class="flight-det">
      <!-- Vuelos (ida y vuelta) -->
      <ng-container
        *ngFor="
          let flight of [formattedFlights?.outbound, formattedFlights?.inbound];
          let i = index
        "
      >
        <div class="flight-info" *ngIf="flight">
          <div class="flight-route-integrated">
            <div class="flight-type-container">
              <span class="flight-type">{{ i === 0 ? "Ida" : "Vuelta" }}</span>
            </div>
  
            <div class="flight-route">
              <div class="departure">
                <div class="flight-first-line">
                  <span class="time-block">
                    <span class="">{{ flight.date | date: 'dd/MM/yy' }}</span>
                    <span class="">{{ flight.departureTime }}</span>
                  </span>
                </div>
                <div class="flight-second-line">
                  <div class="airport">{{ flight.departureAirport }}</div>
                </div>
              </div>
  
              <div class="flight-details">
                <!-- <div class="duration">{{ flight.duration }}</div> -->
                <div class="line-container">
                <div class="line"></div>
                  <span class="layovers-text" *ngIf="flight.layovers && flight.layovers.length > 0">
                    <span class="layover-dots">....</span>
                    <span class="layover-code" *ngFor="let layover of flight.layovers; let i = index">
                      {{ layover }}<span class="layover-dots" *ngIf="i < flight.layovers.length - 1">....</span>
                    </span>
                    <span class="layover-dots">....</span>
                  </span>
                </div>
                <div class="flight-info-compact">
                  <span *ngIf="!flight.hasStops">Directo</span>
                  <span *ngIf="flight.hasStops">{{ flight.stops }} escala{{ flight.stops > 1 ? 's' : '' }}</span>
                </div>
              </div>
  
              <div class="arrival">
                <div class="flight-first-line">
                  <span class="time-block">
                    <span class="">{{ flight.date | date: 'dd/MM/yy' }}</span>
                    <span class="">
                      {{ flight.arrivalTime }}
                      <span class="next-day" *ngIf="flight.isNextDay">+1</span>
                    </span>
                  </span>
                </div>
                <div class="flight-second-line">
                  <div class="airport">{{ flight.arrivalAirport }}</div>
                </div>
              </div>
            </div>
          </div>
  
          <!-- Detalles de segmentos (en formato tabla) -->
          <div class="segments" *ngIf="flight.segments && flight.segments.length > 1">
            <table class="segment-table">
              <tbody>
                <tr
                  *ngFor="
                    let segment of flight.segments;
                    trackBy: trackByFlightNumber
                  "
                >
                  <td>
                    <div class="segment-airline">
                      <img
                        *ngIf="segment.flightNumber"
                        [src]="getAirlineLogoUrl(segment.flightNumber)"
                        class="airline-logo"
                        alt="Logo aerolínea"
                        loading="lazy"
                      />
                      {{ segment.airline }}
                    </div>
                  </td>
                  <td>{{ segment.flightNumber }}</td>
                  <td class="segment-times">
                    {{ segment.departureTime }} {{ segment.departureIata }} →
                    {{ segment.arrivalTime }}
                    <span class="next-day" *ngIf="segment.isNextDay">+1</span>
                    {{ segment.arrivalIata }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </ng-container>
  
      <!-- Mensaje si no hay vuelos -->
      <div
        class="no-flights"
        *ngIf="!formattedFlights?.outbound && !formattedFlights?.inbound && !loading"
      >
        No hay información de vuelos disponible para esta reserva.
      </div>
    </div>
  </p-panel>
  
  <!-- Estado de carga -->
  <div class="loading-state" *ngIf="loading">
    <i class="pi pi-spin pi-spinner"></i>
    <span>Cargando información de vuelos...</span>
  </div>