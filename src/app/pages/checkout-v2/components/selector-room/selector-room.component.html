<!-- Información de viajeros -->
<div class="travelers-info" *ngIf="(travelersNumbers$ | async) as travelers">
  <div class="travelers-summary">
    <i class="pi pi-users"></i>
    <span class="travelers-text">
      <strong>{{ getTotalTravelers() }}</strong> viajero<span *ngIf="getTotalTravelers() !== 1">s</span>:
    </span>
    <span class="travelers-breakdown">
      <span *ngIf="travelers.adults > 0" class="traveler-type">
        {{ travelers.adults }} adulto<span *ngIf="travelers.adults !== 1">s</span>
      </span>
      <span *ngIf="travelers.childs > 0" class="traveler-type">
        {{ travelers.childs }} niño<span *ngIf="travelers.childs !== 1">s</span>
      </span>
      <span *ngIf="travelers.babies > 0" class="traveler-type">
        {{ travelers.babies }} bebé<span *ngIf="travelers.babies !== 1">s</span>
      </span>
    </span>
  </div>
</div>

<!-- Indicador de proceso y guardado -->
<div class="processing-status" *ngIf="processingStatus">
  <div class="status-content">
    <span class="status-text">{{ processingStatus }}</span>
    <div class="progress-bar" *ngIf="savingCountdown > 0">
      <div 
        class="progress-fill" 
        [style.width.%]="((1200 - savingCountdown) / 1200) * 100"
      ></div>
    </div>
  </div>
</div>

<div class="room-selector" [class.saving]="saving">
  <div
    *ngFor="let room of roomsAvailabilityForTravelersNumber; let i = index"
    class="room-item"
    [ngClass]="{ selected: selectedRooms[room.tkId] > 0 }"
  >
    <div class="room-price-data">
      <p>
        {{ room.name }}
      </p>
      <p *ngIf="room.basePrice > 0">
        +{{ room.basePrice | currencyFormat : "EUR" }}
      </p>
      <p *ngIf="room.basePrice < 0">
        {{ room.basePrice | currencyFormat : "EUR" }}
      </p>

      <p-inputNumber
        [(ngModel)]="selectedRooms[room.tkId]"
        (ngModelChange)="onRoomSpacesChange(room, $event)"
        [min]="0"
        [max]="8"
        [showButtons]="true"
        buttonLayout="horizontal"
        spinnerMode="horizontal"
        placeholder="0"
      >
        <ng-template #incrementbuttonicon>
          <span class="pi pi-chevron-up"></span>
        </ng-template>
        <ng-template #decrementbuttonicon>
          <span class="pi pi-chevron-down"></span>
        </ng-template>
      </p-inputNumber>
    </div>

    <p class="room-description">
      {{ room.description }}
    </p>
  </div>
</div>

<div class="messages">
  <div *ngIf="isSharedRoomSelected" class="info-message">
    <i class="pi pi-info-circle"></i>
    <p>
      La asignación de compañero se realiza por orden de reserva. En caso de no
      tener compañero una semana antes de la salida, deberás abonar el
      suplemento individual. Puedes asegurar el precio agregando el seguro de
      habitación.
    </p>
  </div>

  <div *ngIf="hasBabies" class="info-message">
    <i class="pi pi-info-circle"></i>
    <p>
      Al tener al menos un bebé en la reserva se requiere agendar una habitación
      con 2 espacios.
    </p>
  </div>

  <div *ngIf="errorMsg" class="error-message">
    <i class="pi pi-info-circle"></i>
    <p>{{ errorMsg }}</p>
  </div>
</div>

<!-- Indicador de carga de viajeros -->
<div *ngIf="loadingTravelers" class="loading-indicator">
  <i class="pi pi-spin pi-spinner"></i>
  <span>Cargando viajeros...</span>
</div>
