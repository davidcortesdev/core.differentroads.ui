<section class="hero">
  <!-- Video de fondo dinámico -->
  <video
    *ngIf="isVideo && getBannerUrl()"
    class="hero-bg"
    autoplay
    loop
    muted
    playsinline
    preload="auto"
    (loadeddata)="onVideoLoaded()"
    (canplay)="onVideoCanPlay()"
    #videoElement
  >
    <source [src]="getBannerUrl()" type="video/mp4" />
  </video>
  
  <!-- Imagen de fondo dinámica -->
  <img
    *ngIf="isImage && getBannerUrl()"
    class="hero-bg"
    [src]="getBannerUrl()"
    [alt]="getBannerAltText()"
  />
  
  <div class="hero-search">
    <!-- Mensaje de validación de fechas -->
    <div class="validation-error" *ngIf="showDateValidationError">
      <i class="pi pi-exclamation-triangle"></i>
      <span>{{ dateValidationMessage }}</span>
    </div>
    
    <div class="hero-form">
      <div class="input-lg">
        <p-iftalabel>
          <input
            pInputText
            id="destionationInput"
            autocomplete="off"
            placeholder="Pais, Ciudad, Ofertas, Destinos, todo lo que se te ocurra..."
            class="input-text radius firstElement"
            fluid="true"
            [(ngModel)]="destinationInput"
            (keyup.enter)="searchTrips()"
          />
          <label for="destionationInput" class="label">¿Cuál es tu próximo destino?</label>
        </p-iftalabel>
      </div>
      <div class="input-range">
        <p-iftaLabel [ngClass]="{ 'has-range': formattedRange }">
          <p-datepicker
            [(ngModel)]="rangeDates"
            selectionMode="range"
            [showIcon]="false"
            [numberOfMonths]="2"
            [showButtonBar]="true"
            [minDate]="minDate"
            [maxDate]="maxDate"
            [readonlyInput]="true"
            [firstDayOfWeek]="1"
            dateFormat="dd/mm/yy"
            id="rangeDateInput"
            fluid="true"
            placeholder="Seleccionar fechas de viaje"
            appendTo="body"
            [ariaLabel]="'Selector de fechas de viaje'"
            [showOtherMonths]="true"
            [selectOtherMonths]="false"
            [showWeek]="false"
          >
            <!-- Template personalizado para la barra de botones -->
            <ng-template pTemplate="footer">
              <div class="date-presets" role="group" aria-label="Presets de fechas rápidas">
                <button 
                  type="button" 
                  class="preset-btn" 
                  *ngFor="let preset of datePresets"
                  (click)="applyDatePreset(preset.value)"
                  [attr.aria-label]="'Seleccionar rango de ' + preset.label"
                  [title]="'Aplicar preset de ' + preset.label"
                >
                  {{ preset.label }}
                </button>
                <button 
                  type="button" 
                  class="preset-btn today-btn"
                  (click)="applyPresetFromToday()"
                  aria-label="Seleccionar desde hoy por 7 días"
                  title="Viaje desde hoy por 7 días"
                >
                  Desde Hoy
                </button>
                <button 
                  type="button" 
                  class="preset-btn clear-btn"
                  (click)="clearDates()"
                  aria-label="Limpiar fechas seleccionadas"
                  title="Borrar fechas"
                >
                  <i class="pi pi-times"></i> Limpiar
                </button>
              </div>
              <div class="date-range-info" *ngIf="getDaysInRange() > 0">
                <small class="range-duration">
                  <i class="pi pi-calendar"></i>
                  <strong>{{ getDaysInRange() }}</strong> {{ getDaysInRange() === 1 ? 'día' : 'días' }} de viaje
                  <span *ngIf="dateFlexibility > 0" class="flexibility-badge">
                    ±{{ dateFlexibility }} días
                  </span>
                </small>
              </div>
            </ng-template>
          </p-datepicker>
          <label for="rangeDateInput" class="label">Fechas de viaje</label>
          <div class="input-overlay-text" *ngIf="formattedRange">
            {{ formattedRange }} <span *ngIf="flexibilitySuffix">{{ flexibilitySuffix }}</span>
          </div>
        </p-iftaLabel>
      </div>
      <div class="input-md">
        <p-iftaLabel>
          <p-select
            [options]="tripTypes"
            [(ngModel)]="selectedTripType"
            id="tripTypeInput"
            placeholder="Seleccionar tipo"
            [style]="{'width': '100%'}"
            class="border"
            [appendTo]="'body'"
            [showClear]="true"
            styleClass="custom-select-panel"
            [inputId]="'tripTypeInput'"
            fluid="true"
            optionLabel="name"
            optionValue="code"
          >
          </p-select>
          <label for="tripTypeInput" class="label">Tipo de viaje</label>
        </p-iftaLabel>
      </div>
      <div class="input-sm">
        <p-button
          type="button"
          icon="pi pi-search"
          fluid="true"
          styleClass="btn-search radius"
          (click)="searchTrips()"
        ></p-button>
      </div>
    </div>
  </div>
</section>