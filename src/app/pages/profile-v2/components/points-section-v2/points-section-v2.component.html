<div class="points-section">
  <p-toolbar styleClass="toolbar-custom mb-4">
    <div class="p-toolbar-group-start">
      <h1 class="program-title">Programa de puntos</h1>
    </div>

    <div class="p-toolbar-group-end">
      <div class="points-display">
        <span class="points-value">{{ totalPoints }}</span>
        <span class="points-label"> puntos</span>
      </div>
      <button
        pButton
        class="p-button-rounded search-button"
        [ngClass]="{'active': showTable}"
        (click)="toggleTable()"
      >
        <i class="pi pi-search"></i>
      </button>
    </div>
  </p-toolbar>

  <div class="table-container" *ngIf="showTable">
    <p-table
      [value]="points"
      [paginator]="true"
      [rows]="5"
      [showCurrentPageReport]="true"
      [tableStyle]="{ 'min-width': '50rem' }"
      styleClass="p-datatable-striped"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} registros"
    >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="booking">
            Reserva
            <p-sortIcon field="booking"></p-sortIcon>
          </th>
          <th pSortableColumn="category">
            Categor√≠a
            <p-sortIcon field="category"></p-sortIcon>
          </th>
          <th pSortableColumn="concept">
            Concepto
            <p-sortIcon field="concept"></p-sortIcon>
          </th>
          <th pSortableColumn="tour">
            Tour
            <p-sortIcon field="tour"></p-sortIcon>
          </th>
          <th pSortableColumn="points">
            Puntos
            <p-sortIcon field="points"></p-sortIcon>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-point>
        <tr>
          <td class="booking-column">{{ point.booking }}</td>
          <td>{{ point.category }}</td>
          <td>{{ point.concept }}</td>
          <td>{{ point.tour }}</td>
          <td [ngClass]="getPointsClass(point.type)" class="points-column">{{ getFormattedPoints(point) }}</td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <div class="cards-container">
    <div class="cards-grid">
      <p-card
        *ngFor="let card of membershipCards"
        [styleClass]="getCardClass(card)"
        [style]="{ width: '100%', height: '400px' }"
      >
        <ng-template pTemplate="header">
          <div class="card-image-container">
            <div class="card-image-wrapper">
              <img [alt]="card.title" [src]="card.image" class="card-image" loading="lazy"/>
            </div>
          </div>
        </ng-template>
        <ng-template pTemplate="title">
          <div class="card-header">
            <span class="card-type">{{ card.type }}</span>
            <h2 class="card-title">{{ card.title }}</h2>
          </div>
        </ng-template>
        <div class="card-content">
          <div [innerHTML]="card.benefits" class="formated-content"></div>
        </div>
        <ng-template pTemplate="footer">
          <div class="card-status">
            <span [class.unlocked]="card.unlocked">
              {{ getRemainingTripsText(card) }}
            </span>
          </div>
        </ng-template>
      </p-card>
    </div>
  </div>
</div>