<div class="tour-departures">
  <h1>Elige una fecha y comienza a personalizar tu viaje</h1>

  <div class="filters">
    <div class="city-filter">
      <p-autocomplete
        [suggestions]="filteredCities"
        [(ngModel)]="selectedCity"
        [dropdown]="true"
        placeholder="Sin vuelos"
        (completeMethod)="filterCities($event)"
        (onSelect)="filterDeparturesByCity()"
      ></p-autocomplete>
      <span class="price-from">Desde {{ priceFrom }}€</span>
    </div>

    <div class="travelers">
      <span>{{ travelers.adults }} Adulto</span>
      <span>{{ travelers.children }} Niño</span>
    </div>
  </div>

  <p-dataView #dv [value]="filteredDepartures" layout="list">
    <ng-template #header>
      <div class="departure-header">
        <div class="header-columns">
          <span>Salida <i class="pi pi-arrow-right"></i> Regreso</span>
          <span>Información</span>
          <span>Descuento</span>
          <span>Precio</span>
          <span>Acciones</span>
        </div>
      </div>
    </ng-template>

    <ng-template #list let-departures>
      <div class="departure-list">
        <div class="departure-item" *ngFor="let item of departures">
          <div class="dates">
            <div class="departure-date">
              <span class="day-name">{{
                item.departureDate | date : "EEEE"
              }}</span>
              <span class="day">{{
                item.departureDate | date : "dd MMM"
              }}</span>
            </div>
            <i class="pi pi-arrow-right"></i>
            <div class="return-date">
              <span class="day-name">{{
                item.returnDate | date : "EEEE"
              }}</span>
              <span class="day">{{ item.returnDate | date : "dd MMM" }}</span>
            </div>
          </div>

          <div class="info">
            <p-tag severity="info" value="Grupo" *ngIf="item.group">
              <i class="pi pi-users" style="font-size: 0.7rem"></i>
            </p-tag>
            <p-tag
              severity="warn"
              value="Lista de espera"
              *ngIf="item.waitingList"
              ><i class="pi pi-clock" style="font-size: 0.7rem"></i>
            </p-tag>
          </div>

          <div class="price-info">
            <div class="discount" *ngIf="item.discount">
              <span class="original-price"
                >Antes {{ formatPrice(item.originalPrice) }}</span
              >
              <span class="discount-badge">-{{ item.discount }}%</span>
            </div>
          </div>

          <div class="final-price">
            <span>desde</span>
            <span class="amount">{{ formatPrice(item.price) }}</span>
          </div>

          <div class="actions">
            <p-button
              [label]="item.status === 'complete' ? 'COMPLETO' : 'Añadir'"
              [disabled]="item.status === 'complete'"
              (onClick)="addToCart(item)"
              [severity]="item.status === 'complete' ? 'secondary' : 'primary'"
              [raised]="true"
            ></p-button>
          </div>
        </div>
      </div>
    </ng-template>
  </p-dataView>
</div>
