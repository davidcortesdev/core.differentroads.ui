<div class="tour-departures">
  <h1>Elige una fecha y comienza a personalizar tu viaje</h1>

  <div class="filters">
    <div class="city-filter">
      <p-autocomplete
        [suggestions]="filteredCities"
        [(ngModel)]="selectedCity"
        [dropdown]="true"
        [placeholder]="'Todos los vuelos'"
        (completeMethod)="filterCities($event)"
      ></p-autocomplete>
      <span class="price-from">Desde {{ priceFrom }}€</span>
    </div>

    <div class="travelers">
      <span>{{ travelers.adults }} Adulto</span>
      <span>{{ travelers.children }} Niños</span>
    </div>
  </div>

  <p-dataView #dv [value]="departures" layout="list">
    <ng-template #header>
      <div class="departure-header">
        <div class="header-columns">
          <span>Salida <i class="pi pi-arrow-right"></i> Regreso</span>
          <span>Información</span>
          <span>Descuento</span>
          <span>Precio</span>
          <span>Acciones</span>
        </div>
      </div>
    </ng-template>

    <ng-template #list let-departure>
      <div class="departure-item">
        <div class="dates">
          <div class="departure-date">
            <span class="day-name">{{ departure.departureDate | date:'EEEE' }}</span>
            <span class="day">{{ departure.departureDate | date:'dd MMM' }}</span>
          </div>
          <i class="pi pi-arrow-right"></i>
          <div class="return-date">
            <span class="day-name">{{ departure.returnDate | date:'EEEE' }}</span>
            <span class="day">{{ departure.returnDate | date:'dd MMM' }}</span>
          </div>
        </div>

        <div class="info">
          <p-tag severity="info" value="Grupo" *ngIf="departure.group"></p-tag>
          <p-tag
            severity="warn"
            value="Lista de espera"
            *ngIf="departure.waitingList"
          ></p-tag>
        </div>

        <div class="price-info">
          <div class="discount" *ngIf="departure.discount">
            <span class="original-price">Antes {{ formatPrice(departure.originalPrice) }}</span>
            <span class="discount-badge">-{{ departure.discount }}%</span>
          </div>
        </div>

        <div class="final-price">
          <span>desde</span>
          <span class="amount">{{ formatPrice(departure.price) }}</span>
        </div>

        <p-button
          [label]="departure.status === 'complete' ? 'COMPLETO' : 'Añadir'"
          [disabled]="departure.status === 'complete'"
          (onClick)="addToCart(departure)"
          [severity]="departure.status === 'complete' ? 'secondary' : 'primary'"
          [raised]="true"
        ></p-button>
      </div>
    </ng-template>
  </p-dataView>
</div>
