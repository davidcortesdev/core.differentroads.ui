<div class="reviews-section" role="region" aria-label="Customer Reviews">
  <!-- Skeleton loader -->
  <div *ngIf="loading" class="skeleton-container">
    <p-carousel
      [value]="skeletonArray"
      [numVisible]="6"
      [numScroll]="1"
      [circular]="true"
      [responsiveOptions]="responsiveOptions"
      [showNavigators]="false"
      [showIndicators]="false">
      <ng-template let-item pTemplate="item">
        <div class="padre">
          <p-card class="review-card skeleton-card">
            <div class="skeleton-traveler-name"></div>
            <div class="skeleton-tour-name"></div>
            <div class="skeleton-review-text"></div>
            <div class="skeleton-footer">
              <div class="skeleton-date"></div>
              <div class="skeleton-rating"></div>
            </div>
          </p-card>
        </div>
      </ng-template>
    </p-carousel>
  </div>

  <!-- Actual reviews -->
  <p-carousel
    *ngIf="!loading && enrichedReviews?.length"
    [value]="enrichedReviews"
    [numVisible]="6"
    [numScroll]="1"
    [circular]="true"
    [responsiveOptions]="responsiveOptions"
    [autoplayInterval]="carouselConfig.DEFAULT_AUTOPLAY_INTERVAL"
    [showNavigators]="true"
    [showIndicators]="true">
    <ng-template let-review pTemplate="item">
      <div class="padre">
        <p-card class="review-card">
          <ng-template #title>
            <span class="traveler-name" [title]="review.traveler">{{ review.traveler }}</span>
          </ng-template>
          <ng-template #subtitle>
            <span class="tour-name" [title]="review.tour">{{ review.tour }}</span>
          </ng-template>
          <ng-template #content>
            <div
              class="review-text-container"
              [attr.aria-label]="'Review by ' + review.traveler"
              [innerHTML]="review.review | nl2br"
              [title]="review.review"
              (click)="openFullReview(review)">
            </div>
          </ng-template>
          <ng-template #footer>
            <span
              class="date"
              [attr.aria-label]="'Review date: ' + review.date"
              >{{ review.date | date : "dd/MM/yyyy" }}</span>
            <p-rating
              [ngModel]="review.score"
              [readonly]="true"
              [stars]="5">
            </p-rating>
          </ng-template>
        </p-card>
      </div>
    </ng-template>
  </p-carousel>
</div>

<!-- Modal de reseña completa -->
<p-dialog 
  [(visible)]="showFullReviewModal" 
  [modal]="true"
  [dismissableMask]="true"
  [style]="{width: '90%', maxWidth: '600px'}"
  [header]="'Reseña'"
  [closeOnEscape]="true">
  <div class="full-review-content">
    <h3 class="traveler-name">{{ selectedReview?.traveler }}</h3>
    <h4 class="tour-name">{{ selectedReview?.tour }}</h4>
    <div class="review-text" [innerHTML]="selectedReview?.review ||'' | nl2br"></div>
    <div class="review-footer">
      <span class="date">{{ selectedReview?.date | date : "dd/MM/yyyy" }}</span>
      <p-rating
        [ngModel]="selectedReview?.score"
        [readonly]="true"
        [stars]="5">
      </p-rating>
    </div>
  </div>
</p-dialog>
